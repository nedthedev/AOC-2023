#!/usr/bin/python

FINAL_INPUT = """...................................................................................................................................
....#...........#...#...........................#....................................#....##........#..........#.....#.............
..........#...##..#.....................#.#.#..................................#.#..#..#............#........#.....................
....#................##.....................#..........#........................##.#...#..#......#...#......#....#.................
.#..#.................................#.................................................#..#............#..#.##.#.#.........###....
..#...#.#.......#......#...........#................#............................................##.........#...#...#....##........
................#.#..........#..........##..#..............................#...#................#.#......##.......#............#...
........#.#...#..#.##.#.....#......................#.#.............................#....#......#.#.#...#........#..................
.#...##.........#..#..........#....#.....#...........................................#........#.......#.......#...........#........
.........##............#.......#..#.......#...#.#.....................................#..###.......###.........#.....#...#.....#...
.#..#.......#....#..#............#.....#............................#................#.........##...................#..#.#..#......
.#.................###..#...........#.........#................##....#...........#...........#.....................................
.....##.........#..#..........#.....##....#................#..##...................#......#.....#..#.....#.#.......................
..........#......#..............#..#...#..............................................#...........#.#........#............#.#......
...........#.#......#.....#.#.....#.....................#...........#....#.............#.#......##...#......#.....##...............
..............#...##....##.....#......#...............#.#.#...#.....#.................#.#.............#...............#....#.#.#...
.##.#........#.........#.#.#....#....#.......#.........................#...............#..........#.....##....#...............##...
.....#.......##............#.........#....#.................#.................#.......#...............#......................#...#.
...............#..........................#........#..#.......##..#....#..#...#................#....#...#.........#.#.#..#......#..
..........#..#..#..#.##.........#......#.......................#.....#.........#......................#...#.##......#....#....#....
....#.........#......#................#..#.............##.#......................#...........#..#.............#....##........#.....
.............#...#.................#...#...........#...#.#......#......#.......................#.................#....#.#....##....
.......#.#.....#..........#.....#.##............#.#......#........#...#.......##................#................#.......#.........
.#.....................#..#.....#.#...........................#..................#...........#....#......##..............#.....##..
.....#..............#....#.....................#..##...........................#..................#...................#.........#..
....#..#.##........#.....#.........................................#......#.......................#....#....#...#...#....#...#.....
...................#....###....#............#..#.............#.#......#........##.................#...#....#.....#.##..............
......#...#........#....#.....#................#...............................#........................##..#..#......##........#..
.#.....#..........#....#........#................#....#...#..#..#.............#..#..........................#.........#..........#.
.......................#.....#.................#.....................................##.#.........#..................#.....#....#..
.#..................#....#....#...........#....#...#..#..#.............#....#....#####....#.........#.......#..#..###...........##.
....#.......#.#............#.#.................##.............#.#.#....#...##...#...#...............##.###...........##......#...#.
.....#...#...#.........#.....................#....##..#........#......#.................#.#...................#.#..............#...
........##.....##.........#.#......................................#..........#.....#.#.....#.#..............#..........#..........
........#....#.........#..#..............##.....#.....#.....#............#............#....................#.....#.....#.......#.#.
......##...........................#............#.....#.#..............#...........#.......................................#.......
.#.......#...#....#...............................#....##...#..........#.##........##....#................##...........#...........
.#.##.........#.................#................#.#..#.#................#.................................#.......................
.#..#..............#.##.........##.....................................#.....#........#.#..##..#..##............#..........#...#...
....#.##...........###.........#.....#........##...#...#......##..#...............#.#.......#...#.#..........#..........#..........
..........#.....#.....................#..##..#.#.##.............#..............#.............#......##...........##....#.......#...
.....#.......#..................#..........#.......#........#..........##.....#....#...........................#..............#....
.........#.......................##...............#......#.....#...#..........#.#..#...................#...................#.##....
.........#..............................##......##...#..............#...##......#..............#.....#.......................#.....
....#............................#...#..#.#.......#.............#...............#.....#..................#........#.........#......
..#.....................##........#......#...#....#.#..............#...............#.........#...#....#.###..........#....#..#..#..
...........#...#.................#.........#..##.#......#.#.................#..#.......#..............................#..........#.
.....#.#.................##.#.....#....#.........#.....#..#...#.......##..#................................##.................#....
.......#..............#.......#................#.......#..............##.....#...#...#.............................................
.#......#.................#......#.......#.........#...........#...#.......#...#...#......#.......#.#.....#...#..................#.
..#...#...............#.......#.#...................#.....#.#........................#......#....##.#..............................
...##....#......................................#......##.......................#..#...##...............................#...#......
.##..........................................#...............#.......................##.....#...............#.#....................
..#..#...................................##..#.....................................#........##.....#....###......##............#...
...#............#.......#.........#..#.....#.......#.........##........................#...#...#.#..#....#.#.##....#........##.#...
.....#...........#.#....#..............#.....#..............#.................#.......#....#................#....#.................
....#............#......#.............#....#.#...##..#....#.#...#......#.......#...........#..........#.......#....................
...##..............#......#...#........#.........#...#....#............#..#..........#.#..#.......#...#.........#.....#............
.............#.##.........#...#....##.#...#...........##...........##..#....#.......#............##................#...............
.............#..##...#.#.#.#..#.#............#...#......#...#.....#.........###....#..............#............#.#.....#........##.
..........#.................#.....#.........#.#......#.#...........#.......#...............#..#..........#........#.....##.......#.
....................#................#......................#..............#........##...#......#....#...........#.#....#..........
..................#.....#.#.#....#...#..........................#...#...........................................#....#...#.........
......#..........#.#..#........#.....#.......................#.........#......#.............#..............................#.......
...........##....#..#........#...#............#...............#.#.##.#.#.#............#...#........#.....#..#.#...#......#.........
.................................................................S.................................................................
.....#........#......#...........#..#............#..............#........###........#......#............#.....#....#...#...........
..................................#..#................#........#.........#...#.#.......#..#..........#...........#......#.#........
............#.........###........#........##........................#...#.....#......#..##..#.......#..###..............#..........
..........#..............................................#...............#..............#............#.#...#..............#........
...........#...#..#...##...........#............#.....#.#..#..#........#..#...............#...............#.....#.....#.##.........
.....................#....#..........#..#..................#..#.........#......#..................#.................#..#...........
............#....#.#...............#.....#..........##..............#...#.#....#....#......#.......................................
.#...........#............#..#..#....................................#.......#......#.....#....#.............#.....................
..#.#...........#.............#...............#...#.....#.......#.............#.........#.#.........#..........#...................
..............#................##.#.#.#.#......#...#...........#....#.#.....................#...........##.#..#.............#.##...
...#...............#..........................##........#..#.....................#...........#...#...#.#...#......##...............
........#..........#...#..........#...#.....#............#.......................#.#..........#...#..........................##....
.......#..............#.............#.......##.#..#...#........#.....#..#.....#....#............................#........#...#.....
..........#.............#...........#........#..#...###....#..........#...#....#..............#.##.............#.........#...#.##..
.........................#.#..........#.....#.........##.#..............#.....##.........#.##.....#.....#..........................
....#....#.................#..........#...#.....##.#...#....#.........##.....#.##.............................................#....
...#....#.#............#...........................#......................#..#..#...###............#...#...........................
..............#............#................#...#.#..........................#....................#...#.#............#.....#.....#.
.......#.......#........#..................#.#....#...#..............#......#...............#.......##...#.................#.......
.....#.#..............................#.#...#..................#...........#.##................#...................#..#.#..........
.....#..........#..........#.#.....#.........#....................#..#..#.......#......................##................#.....#...
....#..................................#....#........#.........#..........#...#.........#..#..........#.............#.......#..#...
.#.................#........#..#.#......#..#.#.....#..#.........#......#......#.#........#.....#.#....#............#.......#.##....
...............#................#..........#...#.#...#...#....#.#..#...........#....#..............................#............#..
.........#...........#.........#................................#...#..#........................................#....#.#...........
...#..................#...........#........#................#.#....#............#...#........................#...#.................
.#..............##.....#.......#......#..............#..........................#.#...........#............#...........#....#......
........#....#......................#................#........#...................#.........................#.#....#............##.
...........#.........#.#...........##......##..#.#..#.....................#.#......#...........#.............#.....................
...........#...##.........#...........................#......##.......#......#...............#.#...........#.##...#..#..#..#..#....
....#...##..#.#..#.#....#...........#.........#.....#.........#.#.....................#..................#..........#........##.#..
.....##....#..........#.#...........#....#..............#................#.......#....................##......#....................
.#..#..#........#....................#..#.#....#........##.....##.#......#.....#......#....#.....................#......#..###.#...
.........#...#...............#.........#..#............#.#....#.........#.............#...#.................#..............##......
...##........#.#.#.....##..#........................#....#...#...........#..........#.#............#.#...#.............#...........
...##..............#......##.................#...........#..........#..............##......................#...#.....#....#..#.....
........#........#........#.................###.................................#....................##.#.#...#...............#..#.
.......#.......................................#..........#..........................#.#............#.........#..#..##.............
.........#.........................#................#................#...#.......#..#..#.......#.........###.......................
........#.....#......###.#...............................#........#....#.....#..##.............................#..#...#........#...
...........#.#....#..........#.#...#..........####.#......####.#....................#.............................#................
...##.............#..#........#................#......................#...#......#..#........#......#..................#...#.#...#.
.#........#.......#.......#.......#................#........#..#.....#...........#.........#.......#.#........#........##...#..#...
..........#.......#............#.........................#.................#....#...........##.........#...#................#....#.
.........##.#.....#...#..##..............................#..................................##......##..#..........................
........#......###..#....#....#.##....#..............#........#...#.........................................#........#...........#.
.......#.....#.#..#....#..........#...#.#..#....................#........#..............#......#..#..#....#............#.......#...
...........#.##..#......##.#...............#.............#.##.............#.......................#...........##...................
.###.....................#.#..........................................#.#.................#........#............#.........#........
.....#....#......#..#.....#............#..............................................#....##.......#........#..#..........#.......
.......#......................................................##...#.................#.......................##....................
......#.#....#...#...............#.#...#..#...............##......#..#............#.....#.......#.................#..##..#.#.....#.
............#........#..#.........#....#......##.#........#....#..#...........................#...............#............##......
.....#....#.##.......................#....................#.#.................................................#....##....#...#.....
..............###..#.....#........#.........##.#...........#.#.#...#.............#......#...............#.##...........##..........
........................#..#.........#.....#.......#.........#.....#................#.#.#..........................#.#......##.....
.......##........#......#........#.##.#.#........#......................................#......#...#.#...#.......#..#.....#........
.#.....####..........#......#.......................#.............#...........#.....#.......#.#.....................#..............
...#.....#...##.............#...............#..##..................#................#..........#...#........#.......#..............
.#.........#..#...#.#....#....#.......#...........#...............#...............#...#........#..........................#........
...............#....#........###.......#....................................#.................#...........#.........#..#...........
.......#......#..#.....#.........#.........#............#.......................#..#........#...#..#.....#.......#.............#...
........................#.............#........#..........#.................#......##.#..#...#.............#...........#...#....#..
....#.....#....#......#...#...#...................#..##.................#..........##.##...............#..........##...............
...................................................................................................................................""".split("\n")

TEST_INPUT = """...........
.....###.#.
.###.##..#.
..#.#...#..
....#.#....
.##..S####.
.##..#...#.
.......##..
.##.#.####.
.##..##.##.
...........""".split("\n")

class Grid:
    def __init__(self, grid):
        self.grid = []
        self.farmer = None
        for row in range(len(grid)):
            self.grid.append([])
            for col in range(len(grid[0])):
                if(grid[row][col] == "."):
                    self.grid[row].append(Cell(True))
                elif(grid[row][col] == 'S'):
                    self.grid[row].append(Cell(True))
                    self.farmer = self.grid[row][col]
                    self.farmer.distance = 0
                else:
                    self.grid[row].append(Cell(False))
        for row in range(len(self.grid)):
            for col in range(len(self.grid[row])):
                self.grid[row][col].neighbors = self.get_neighbors(row, col)

    def get_neighbors(self, row, col):
        neighbors = []
        if(row > 0 and self.grid[row-1][col].is_farm()):
            neighbors.append(self.grid[row-1][col])
        if(col > 0 and self.grid[row][col-1].is_farm()):
            neighbors.append(self.grid[row][col-1])
        if(row < len(self.grid)-1 and self.grid[row+1][col].is_farm()):
            neighbors.append(self.grid[row+1][col])
        if(col < len(self.grid[0])-1 and self.grid[row][col+1].is_farm()):
            neighbors.append(self.grid[row][col+1])
        return neighbors
    
    def print(self):
        for row in self.grid:
            row_str = ""
            for cell in row:
                # if(cell.distance < 4096):
                #     row_str += str(cell.distance)
                # else:
                #     row_str += "-"
                if(cell.traversed):
                    row_str += "x"
                elif(cell.is_farm()):
                    row_str += "."
                else:
                    row_str += "#"
            print(row_str)
        print()

class Cell:
    def __init__(self, farm):
        self.farm = farm
        self.neighbors = []
        self.distance = 4096
        self.traversed = False

    def is_farm(self):
        return self.farm
    
    def get_neighbors(self):
        return self.neighbors
    
    def traverse(self, steps):
        queue = [self]
        could_reach = 1
        self.traversed = True
        while(len(queue) > 0):
            cell = queue.pop(0)
            for neighbor in cell.get_neighbors():
                if(cell.distance+1 <= steps and neighbor.distance > cell.distance+1):
                    queue.append(neighbor)
                    neighbor.distance = cell.distance+1
                    if(neighbor.distance % 2 == 0 and not neighbor.traversed):
                        could_reach += 1
                        neighbor.traversed = True
        return could_reach

if __name__ == "__main__":
    g = Grid(FINAL_INPUT)
    # g.print()
    print(g.farmer.traverse(64))
    # g.print()

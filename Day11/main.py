#!/usr/bin/python

import time

def final_input():
    return """....................#........#...............................#............................................................#................#
............#...................................#........................................#........#..................#...........#..........
.#.......................#..................................................................................................................
..........................................................#.................................................#...............................
...................................#..........................................#.............................................................
...........................................#......................#.........................................................................
......................#.....................................................................................................................
..................................................#.........#.........#.......................#............................#.......#......#.
......#.........#............#.............................................#................................................................
.#................................#.....................#.......................#........................#..................................
..........................................#.................................................................................................
.......................................................................................#......................#.............................
.....................................................................#..............................................#.....#.................
........#.................#.................................................................................................................
....................................#.................#........................................................................#............
.............#...........................#.......................#................#..................#.................................#....
#...........................................................................#...............................................................
......................#......#..............................................................................................................
.................................................#........................................................#.................................
.....................................#...................................................#........................#.........................
........#................#................................#.................................................................................
...................#................................................................#........#...............#..............#...............
.......................................................................................................#..........................#.........
..................................#.......#.........................................................................#...................#...
.............#.................................#........................#...................................................................
.....................#..................................#......................................#................#...........................
...............................................................#.....................#..................................#...................
#.........#...................#................................................#........................#...................................
...................................#..................................#............................................................#........
............................................#.........#...........................................#.........................................
...#.............................................#........................................................................#.................
........#..........#........#.................................................................................#.................#......#....
..............................................................#..................#..........................................................
.....................................................................#......................................................................
.................................................................................................................#..........................
...............#...............................#....................................................#.......................................
...........................#................................................................#........................................#......
...........#.....................#..................#............#...........#.......#.....................#................................
............................................................................................................................................
...............................................................................................................................#.........#..
.......................................................................................................................#....................
........#................#.....#.....#.................#.........................................#..........................................
..................................................#...................................#.....................................................
....#...........#.............................................................#..............#...............#...................#..........
............................................#...............#.........................................................................#.....
....................#.......................................................................................................................
#......#..........................#..................#...............#.....#................................................................
...........................................................................................#......................#........................#
...........#................................................................................................................................
...............................................................................#...................#........................................
.......................#..............#......#..............#...........................#..................................#................
............................................................................................................................................
...................#...........#.................................................................................................#..........
.......................................................................................................#.....#..............................
........................................................#...........................#................................#......................
...............#...................................................#..........#...........#.................................................
...........................................#......................................................#.........................................
.........#.......................................#..........................................................................................
..........................#...............................................................................#........#......................#.
...........................................................#...............#...........#......#..........................#..................
.................#......................#.............................#........................................................#............
.............................................................................................................#..............................
...............................#...............................................#............................................................
............................................#.........#.....................................................................#...............
...#......................#........#.............................................................#..................#.....................#.
................................................#..............#.......................#..............#.....................................
............................................................................................................................................
#...........................................................................................................................................
......#..............#....................................#........#................................................................#.......
..............#.............#.........#..........................................#..........................................................
..................................................................................................#............................#..........#.
...........................................#...................#.......................................#.....#..............................
.................................#....................#................................#....................................................
............................................................................................................................................
........................................................................#...................................................#...............
..#..............................................#...........................................#...................#.....#.............#......
......................#.....................................................................................................................
...............................#......#..........................................................#.......#.....................#............
..........#.....#.................................................#.............#...........................................................
............................................................................................................................................
............................#.................................#.........#...................................................................
.......................................................#................................#...........................#.......................
...........................................................................................................................#.........#......
...................#..............................#..............................#...............#.........#................................
..........#..............#.....................................................................................................#............
............................................................................................................................................
................#.........................................................#...............................................................#.
.................................#.....................................................................#....................................
.....#................................................#.....................................#...............................................
.............................#...............................#................#..............................#..............................
......................................................................................#...............................#........#............
............................................................................................................................................
...........#..........#..............................................#..............................................................#.......
................................................#..............#...................................................#........................
......#...........#.........................................................#...............#...............................................
...............................#.....................................................#...............#...................................#..
..............#.......................#.....................#...............................................................................
.........................#........................#...........................................................................#......#......
.........................................................................................................#..................................
............................................................................................................................................
...#......................................................#.................................................................................
........................................#.................................................#........#..............#.....#...................
....................#................................#..........................#...........................................................
#.................................#..................................................#.........#.......#.............................#......
...........#.........................................................#.......................................................#..............
......#......................#.................#.............................#..............................................................
........................................................#.........................................#............#.................#..........
..................#....................#.....................................................#..............................................
..........................#......................................................#......#................................#..................
................................#............#.........................................................#.................................#..
............................................................................................................................................
...#........................................................#...............................................................................
..............#.....................................#................................................................................#......
....................................................................................................................#...........#...........
...................#.........................................................................#..............................................
.............................#........#.....................................................................................................
................................................................#................................................#..........................
..#..........#...................................#..............................#........#................#.................................
..................................#........................................................................................#................
.....................#....................................#....................................#.....#......................................
........#.......#..............................................................................................#...................#........
...........................#..............#..........#............#......................................................................#..
.#..........................................................................................................................................
............#....................................#.....................................................................#....................
.............................................................#.............#.........#.....#........#.......................................
......#...........................#.......................................................................#.................................
........................................................#..................................................................#................
#..........................#.............#.........................#..........#...................................#.........................
....................#....................................................................#.............#..........................#.....#...
............................................................................................................................................
.....................................................#..................#................................................#..................
...#....................#......#............................#.....................#.................#.......................................
............#...................................#...........................................................................................
............................................................................................#...............................................
...................#...................................................................#..................#.................#.........#.....
#.................................#........#..........#..........................................#..........................................
.....#......................................................................................................................................
.......................#................................................#........................................#..........................
.................................................................#...........#............#..........#...................................#..
..............#......................#.......#.........................................................................#....................""".split("\n")

def test_input():
    return """...#......
.......#..
#.........
..........
......#...
.#........
.........#
..........
.......#..
#...#.....""".split("\n")

class Grid:
    def __init__(self, data):
        self.grid = self.grid_to_cells(self.expand_space(data))
        self.link_cell_neighbors()
        self.galaxies = self.find_galaxies()

    def expand_space(self, data):
        for row_count, row in enumerate(data):
            if '#' not in row:
                data = data[:row_count+1] + ["." * len(row)] + data[row_count+1:]
        columns_to_dup = []
        for col in range(len(data[0])):
            empty = True
            for row in range(len(data)):
                if(data[row][col] == "#"):
                    empty = False
                    break
            if(empty):
                columns_to_dup.append(col)
        for added, col in enumerate(columns_to_dup):
            for row_num in range(len(data)):
                data[row_num] = data[row_num][:col+added+1] + "." + data[row_num][col+added+1:]
        return data
    
    def print(self, grid=None):
        for y, row in enumerate(self.grid):
            string = ""
            for x in range(len(row)):
                string += str(self.grid[y][x].weight) + "\t"
            print(string)

    def grid_to_cells(self, grid):
        cell_grid = []
        for y, row in enumerate(grid):
            cell_grid.append([])
            for x in range(len(row)):
                cell_grid[y].append(Node((x, y), grid[y][x]))
        return cell_grid
    
    def reset(self):
        for row, cells in enumerate(self.grid):
            for col in range(len(cells)):
                self.grid[row][col].reset()

    def link_cell_neighbors(self):
        for row, cells in enumerate(self.grid):
            for col in range(len(cells)):
                north = east = south = west = None
                if(row-1 >= 0): north = self.grid[row-1][col]
                try: east = self.grid[row][col+1]
                except: pass
                try: south = self.grid[row+1][col]
                except: pass
                if(col-1 >= 0): west = self.grid[row][col-1]
                self.grid[row][col].neighbors = (north, east, south, west)

    def find_galaxies(self):
        galaxies = []
        for y, row in enumerate(self.grid):
            for x in range(len(row)):
                if(self.grid[y][x].symbol == "#"):
                    # self.grid[y][x] = Galaxy(self.grid[y][x])
                    galaxies.append(self.grid[y][x])
        return galaxies

class Node:
    def __init__(self, coord, symbol, cost=1):
        self.coord = coord
        self.symbol = symbol
        self.cost = cost
        self.weight = 8192
        self.traversed = False
        self.distance_map = []
        self.neighbors = []

    def calculate_distances(self, grid):
        # self.grid = grid.grid.copy() # create a copy of the star map
        # self.grid = grid

        stack = [self] # stack to act as queue
        while(len(stack) > 0):
            for node in stack[0].neighbors:
                if(node and stack[0].weight+1 < node.weight):
                    node.weight = stack[0].weight+1
                    stack.append(node)
            stack = stack[1:]

    def reset(self):
        self.weight = 8192

    def print(self):
        print(f"Location: {self.coord}\tSymbol: {self.symbol}\tNeighbors: {self.neighbors}")

# class Galaxy(Node):

#     def __init__(self, node):
#         super().__init__(node.coord, node.symbol, node.weight)
#         self.neighbors = node.neighbors
#         self.grid = []

#     def calculate_distances(self, grid):
#         # self.grid = grid.grid.copy() # create a copy of the star map
#         # self.grid = grid

#         stack = [self] # stack to act as queue
#         while(len(stack) > 0):
#             for node in stack[0].neighbors:
#                 if(node and stack[0].weight+1 < node.weight):
#                     node.weight = stack[0].weight+1
#                     stack.append(node)
#             stack = stack[1:]
#             grid.print()
#             time.sleep(.1)

if __name__ == "__main__":
    g = Grid(test_input())

    sum = 0
    for index, galaxy in enumerate(g.galaxies):
        galaxy.weight = 0
        galaxy.calculate_distances(g)
        for destination in g.galaxies[index+1:]:
            sum += destination.weight
        g.print()
        g.reset()
    print(sum)
